# å…ƒæ•°æ®ç³»ç»Ÿè®¾è®¡åˆ†ææŠ¥å‘Š
> **ç”Ÿæˆæ—¶é—´**: 2025-12-23 | **éªŒè¯ç‰ˆæœ¬**: v2.5 (å›å½’éªŒè¯ & å·®å¼‚å®šæ€§)

---

## 1. æ¦‚è¦ (Executive Summary)

> [!IMPORTANT]
> **æœ¬æŠ¥å‘Šé‡‡ç”¨å»é‡å£å¾„**ï¼šå­—æ®µå’ŒæŒ‡æ ‡æŒ‰ `(name + formula_hash)` å»é‡ã€‚

| ç»Ÿè®¡é¡¹            | æ•°å€¼                       | çŠ¶æ€                      |
| :---------------- | :------------------------- | :------------------------ |
| **API è®¡æ•°ä¿®å¤**  | åº¦é‡(3341), é‡å¤å…¬å¼(3375) | âœ… **å·²ä¿®å¤** (ä¸ DB ä¸€è‡´) |
| **åƒµå°¸è®¡ç®—æŒ‡æ ‡**  | 774 (å»é‡å)               | âš ï¸ éœ€æ²»ç†                  |
| **å­—æ®µ-è§†å›¾ä¸­æ–­** | 3916 (å»é‡å)              | âš ï¸ éœ€æ²»ç†                  |
| **èµ„äº§æè¿°ç¼ºå¤±**  | 20265 (DB) vs 15177 (API)  | â„¹ï¸ **å£å¾„å·®å¼‚** (è§ä¸‹æ–‡)   |

**å›å½’ç»“è®º**:
æ­¤å‰å‘ç°çš„ API è®¡æ•°ä¸º 0 æˆ–è¢«æˆªæ–­çš„é—®é¢˜**å·²å½»åº•ä¿®å¤**ã€‚ç”±æ­¤æ­ç¤ºå‡ºç³»ç»Ÿä¸­çœŸå®çš„**ä¸¥é‡æ•°æ®è´¨é‡é—®é¢˜**ï¼Œé€šè¿‡æ–°çš„ SQL éªŒè¯è¿˜å‘ç°äº†**åº•å±‚è¡€ç¼˜å®Œæ•´æ€§**ç¼ºé™·ã€‚

---

## 2. é—®é¢˜æ˜ç»† (Issue Details - CSV Aligned)

### 1. ç‰©ç†åŸºç¡€è®¾æ–½

#### 1.1 æ•°æ®åº“ä¸»é”®IDå†²çª
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` âœ…
*   **å‰ç«¯å¸ƒå±€ä½ç½®**: æ— ç›´æ¥å‰ç«¯å±•ç¤º

#### 1.2 å­¤ç«‹æ•°æ®è¡¨è®°å½•
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` âœ…
*   **å‰ç«¯å¸ƒå±€ä½ç½®**: æ•°æ®è¡¨åˆ—è¡¨

#### 1.3 æ— æ•ˆçš„æ•°æ®åº“å¼•ç”¨
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` âœ…
*   **å‰ç«¯å¸ƒå±€ä½ç½®**: æ— ç›´æ¥å‰ç«¯å±•ç¤º

#### 1.4 å­¤ç«‹ç‰©ç†åˆ—è®°å½•
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` âœ…
*   **å‰ç«¯å¸ƒå±€ä½ç½®**: æ— ç›´æ¥å‰ç«¯å±•ç¤º

#### 1.5 æ— æ•ˆçš„æ•°æ®è¡¨å¼•ç”¨
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` âœ…
*   **å‰ç«¯å¸ƒå±€ä½ç½®**: æ— ç›´æ¥å‰ç«¯å±•ç¤º

---

### 2. æ•°æ®æºè¯­ä¹‰å±‚

#### 2.1 æ•°æ®æºåç§°ä¸ºç©º
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` âœ…
*   **API æŸ¥è¯¢ç»“æœ**: è¿”å›ç©ºæ•°ç»„ âœ…

#### 2.2 æ•°æ®æºæœªå½’å±é¡¹ç›®
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` âœ…
*   **API æŸ¥è¯¢ç»“æœ**: è¿”å›ç©ºæ•°ç»„ âœ…

#### 2.3 ç©ºå£³æ•°æ®æº(æ— è¡¨)
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` âœ…

#### 2.4 ç©ºå£³æ•°æ®æº(æ— å­—æ®µ)
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` âœ…

---

### 3. æ¶ˆè´¹å±‚

#### 3.1 å·¥ä½œç°¿æœªå½’å±é¡¹ç›®
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` âœ…

#### 3.2 å·¥ä½œç°¿ç¼ºå°‘è´Ÿè´£äºº
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` âœ…

#### 3.3 å·¥ä½œç°¿åç§°ä¸ºç©º
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` âœ…

#### 3.4 å­¤ç«‹è§†å›¾è®°å½•
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` âœ…

#### 3.5 æ— æ•ˆçš„å·¥ä½œç°¿å¼•ç”¨
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` âœ…

#### 3.6 ä»ªè¡¨æ¿å†…å®¹ç¼ºå¤±
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `57` âš ï¸
*   **å‰ç«¯å¸ƒå±€ä½ç½®**: è§†å›¾è¯¦æƒ…æŠ½å±‰
*   **ç¼ºå¤±å†…å®¹è¯¦è§£**:
    *   **ç°è±¡**: `view_type='dashboard'` ä½† `containedSheets` ä¸ºç©ºã€‚
    *   **ä¸šåŠ¡å½±å“**: ç”¨æˆ·çœ‹åˆ°çš„ä»ªè¡¨æ¿æ˜¯ç©ºçš„ï¼Œæ— æ³•ç©¿é€åˆ° Worksheetã€‚

---

### 4. å­—æ®µä¸æŒ‡æ ‡é€»è¾‘

#### 4.1 å¹½çµå­—æ®µ(æ‚¬ç©º)
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` (å®šä¹‰: æ—  DS ä¸” æ—  WB) âœ…
*   **å‰ç«¯å¸ƒå±€ä½ç½®**: ä¾§è¾¹æ ç»Ÿè®¡ `orphanedFields`

#### 4.2 è®¡ç®—å…¬å¼ä¸¢å¤±
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `2` âš ï¸
*   **å‰ç«¯å¸ƒå±€ä½ç½®**: å­—æ®µè¯¦æƒ…æŠ½å±‰
*   **é”™è¯¯ä¿¡æ¯å…ƒç´ **: `formula` å­—æ®µ

#### 4.3 åº¦é‡æ•°æ®ç±»å‹ç¼ºå¤±
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` âœ…

#### 4.4 è®¡ç®—å­—æ®µè§’è‰²æœªå®šä¹‰
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `0` âœ…

---

### 6. è¡€ç¼˜å…¨é“¾è·¯ (æ–°å¢å‘ç°)

#### 6.1 ç‰©ç†-è¯­ä¹‰è¡€ç¼˜ä¸­æ–­
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `8` âš ï¸
*   **è¯´æ˜**: ç‰©ç†è¡¨æœªå…³è”æ•°æ®æºã€‚

#### 6.2 è¯­ä¹‰-æ¶ˆè´¹è¡€ç¼˜ä¸­æ–­
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `30` âš ï¸
*   **è¯´æ˜**: æ•°æ®æºæœªå…³è”å·¥ä½œç°¿ (åƒµå°¸æ•°æ®æº)ã€‚

#### 6.3 å­—æ®µ-è§†å›¾è¡€ç¼˜ä¸­æ–­ (å»é‡å)
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `3916` âš ï¸
*   **è¯´æ˜**: å­—æ®µæœªåœ¨ä»»ä½•è§†å›¾ä¸­ä½¿ç”¨ã€‚

#### 6.4 è®¡ç®—å­—æ®µå­¤å„¿æ•°æ®æºå¼•ç”¨ (New!)
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `1303` ğŸ”´
*   **ç¼ºå¤±å†…å®¹è¯¦è§£**:
    *   **é—®é¢˜**: è®¡ç®—å­—æ®µå¼•ç”¨äº†ä¸å­˜åœ¨çš„ `datasource_id`ã€‚
    *   **æ ¹å› **: å¯èƒ½æ˜¯æ•°ä»“åŒæ­¥è„šæœ¬åœ¨å¤„ç†å†…åµŒæ•°æ®æºæ—¶ï¼Œæœªèƒ½æ­£ç¡®å…³è”åˆ°å‘å¸ƒçš„çˆ¶æ•°æ®æºã€‚
    *   **å½±å“**: ç‚¹å‡»å­—æ®µæº¯æºæ—¶ï¼Œä¼šæŠ¥ 404 æˆ–æ˜¾ç¤ºæœªçŸ¥æ¥æºã€‚

#### 6.5 è®¡ç®—å­—æ®µç‰©ç†è¡¨è¡€ç¼˜ç¼ºå¤± (New!)
*   **SQL æŸ¥è¯¢ç»“æœ**: å¼‚å¸¸æ•° `5057` ğŸ”´
*   **ç¼ºå¤±å†…å®¹è¯¦è§£**:
    *   **é—®é¢˜**: 5057 ä¸ªè®¡ç®—å­—æ®µçš„ `table_id` ä¸ºç©ºã€‚
    *   **å½±å“**: è®¡ç®—å­—æ®µæ— æ³•å±•ç¤ºå…¶å½’å±çš„é€»è¾‘è¡¨/ç‰©ç†è¡¨ä¿¡æ¯ã€‚

---

### 7. æ²»ç†åˆç†æ€§

#### 7.1 åƒµå°¸è®¡ç®—æŒ‡æ ‡ (å·²ä¿®å¤)
*   **SQL æŸ¥è¯¢ç»“æœ**: `774` (å»é‡å)
*   **API æŸ¥è¯¢ç»“æœ**: `stats.metrics: 3341` (æ€»æ•°) âœ…
*   **çŠ¶æ€**: **ä¿®å¤**ã€‚API ä¸å†æ˜¾ç¤º 0ï¼Œæ­£ç¡®è¯†åˆ«äº†æ‰€æœ‰æŒ‡æ ‡ã€‚

#### 7.2 åƒµå°¸è®¡ç®—ç»´åº¦ (å»é‡å)
*   **SQL æŸ¥è¯¢ç»“æœ**: `374`

#### 7.3 å†—ä½™ç‰©ç†åˆ— (å»é‡å)
*   **SQL æŸ¥è¯¢ç»“æœ**: `2769`

#### 7.4 é€»è¾‘é‡å¤å®šä¹‰ (å·²ä¿®å¤)
*   **SQL æŸ¥è¯¢ç»“æœ**: `3375`
*   **API æŸ¥è¯¢ç»“æœ**: 3375 âœ…
*   **çŠ¶æ€**: **ä¿®å¤**ã€‚API ä¸å†æˆªæ–­ä¸º 202ï¼Œå‡†ç¡®æŠ¥å‘Šäº†å…¨é‡é‡å¤é—®é¢˜ã€‚

#### 7.5 å­—æ®µåæ­§ä¹‰å†²çª
*   **SQL æŸ¥è¯¢ç»“æœ**: `179`

#### 7.9 éè®¤è¯æ•°æ®æº
*   **SQL æŸ¥è¯¢ç»“æœ**: `55`
*   **API æŸ¥è¯¢ç»“æœ**: è®¤è¯ç‡ 0% (å³ 55 ä¸ªæœªè®¤è¯) âœ…

#### 7.10 èµ„äº§æè¿°ç¼ºå¤± (å£å¾„å·®å¼‚)
*   **SQL æŸ¥è¯¢ç»“æœ**: `20265` âš ï¸
*   **API æŸ¥è¯¢ç»“æœ**: `15177`
*   **å·®å¼‚åˆ†æ**:
    *   **API é€»è¾‘**: ä»…ç»Ÿè®¡ `is_calculated=0` çš„ç‰©ç†å­—æ®µ (ä»£ç  `api.py` Line 343)ã€‚
    *   **SQL é€»è¾‘**: ç»Ÿè®¡ `tables` + æ‰€æœ‰ `fields`ã€‚
    *   **ç»“è®º**: API æ˜¯è®¾è®¡å¦‚æ­¤ï¼Œå¹¶é Bugï¼Œä½†è¦†ç›–é¢è¾ƒçª„ã€‚å»ºè®®åç»­æ‰©å±• API è¦†ç›–é¢ã€‚

---

## 3. æ€»ç»“ä¸å»ºè®®

### 1. éªŒè¯å·¥å…·å›å½’çŠ¶æ€
*   âœ… **API å‡†ç¡®æ€§å·²ä¿®å¤**: ä¹‹å‰ä¸¥é‡çš„ API è®¡æ•°é”™è¯¯ (0 æŒ‡æ ‡ã€é‡å¤å…¬å¼æˆªæ–­) å·²å®Œå…¨ä¿®å¤ã€‚
*   â„¹ï¸ **å£å¾„å·®å¼‚å·²æ˜ç¡®**: "èµ„äº§æè¿°ç¼ºå¤±"çš„è®¡æ•°å·®å¼‚æºäº API ä»…å…³æ³¨ç‰©ç†å­—æ®µï¼Œå±äºé¢„æœŸè¡Œä¸ºã€‚

### 2. æ–°å‘ç°çš„ç³»ç»Ÿé£é™© (Integrity)
*   ğŸ”´ **è¡€ç¼˜æ–­é“¾é£é™©**: å‘ç° **1303** ä¸ªè®¡ç®—å­—æ®µå¼•ç”¨äº†ä¸å­˜åœ¨çš„æ•°æ®æº IDï¼Œä»¥åŠ **5057** ä¸ªè®¡ç®—å­—æ®µç¼ºå¤±è¡¨å…³è”ã€‚è¿™è¡¨æ˜ `tableau_sync.py` çš„åŒæ­¥é€»è¾‘åœ¨å¤„ç†å¤æ‚è¡€ç¼˜æ—¶å­˜åœ¨æ¼æ´ã€‚

### 3. æ•°æ®æ²»ç†è¡ŒåŠ¨å»ºè®®
1.  **ä¿®å¤è¡€ç¼˜åŒæ­¥**: è°ƒæŸ¥ 1303 ä¸ªå­¤å„¿æ•°æ®æºå¼•ç”¨çš„æ ¹å› ï¼Œä¿®æ­£åŒæ­¥è„šæœ¬ã€‚
2.  **æ¸…ç†åƒµå°¸èµ„äº§**: ç€æ‰‹ä¸‹çº¿ 3916 ä¸ªå·²ç¡®è®¤å»é‡åçš„æœªä½¿ç”¨å­—æ®µã€‚
3.  **è¡¥å……æè¿°**: ä¼˜å…ˆä¸º 15177 ä¸ªç‰©ç†å­—æ®µè¡¥å……ä¸šåŠ¡æè¿°ã€‚

---
> æŠ¥å‘Šç”Ÿæˆè§„èŒƒè¯¦è§: [claude.md](./claude.md)
