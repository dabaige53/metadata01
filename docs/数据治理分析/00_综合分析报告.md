# Tableau 元数据治理详细分析报告

> **分析时间**: 2025-12-19 15:48  
> **数据来源**: SQLite 元数据库 (metadata.db)  
> **数据同步**: 最新状态

---

## 📊 执行摘要

| 核心指标 | 数值 | 评价 |
|---------|------|------|
| **健康度得分** | **21.6/100** | 🔴 亟需改进 |
| 总资产数 | 15,184 | 含6类核心资产 |
| 数据血缘关系 | 185,082 | 字段→视图 |
| 治理问题数 | 6项严重 | P0/P1级别 |

---

# 一、资产全景详细分析

## 1.1 资产总量统计

| 资产类型 | 数量 | 说明 |
|---------|------|------|
| 数据库连接 | 6 | MySQL/ClickHouse/JDBC |
| 数据表 | 450 | 物理表与视图 |
| 数据库列 | 4,720 | 原生数据库列 |
| 字段 | 8,314 | Tableau定义字段 |
| 计算字段 | 4,778 | `is_calculated=true` |
| 已发布数据源 | 53 | 共享数据源 |
| 工作簿 | 79 | 可视化容器 |
| 视图/仪表板 | 1,564 | 最终展示层 |
| 术语表条目 | 39 | 业务词汇定义 |
| 用户 | 2 | Tableau用户 |

---

## 1.2 数据库连接详情

| 数据库名 | 连接类型 | 主机 | 表数量 |
|---------|---------|------|-------|
| data_sandbox | mysql | dataexplorerdb.juneyaoair.com | 20 |
| 10.12.15.14:8123 | clickhouse_jdbc | 10.12.15.14 | 4 |
| ho | genericjdbc | sharefile.juneyaoair.com | 3 |
| data_sandbox | mysql | 10.17.12.188 | 3 |
| ho | genericjdbc | 其他路径 | 3 |

---

## 1.3 工作簿详情 (Top 10)

| 排名 | 工作簿 | 视图数 | 总访问量 | 所有者 | 项目 |
|-----|-------|-------|---------|-------|------|
| 1 | 销售航段_新 | 119 | 561 | huangguanru | 销售数据 |
| 2 | 销售数据分析平台 | 117 | 1,693 | huangguanru | 销售数据 |
| 3 | 销售分析 | 97 | 488 | huangguanru | 销售数据 |
| 4 | 销售数据分析-国际平台 | 76 | 3,607 | huangguanru | 国际 |
| 5 | OD-TT | 75 | 8 | huangguanru | 默认值 |
| 6 | OAG数据分析汇报 | 61 | 527 | huangguanru | 默认值 |
| 7 | 销售数据分析平台_佳茗 | 58 | 1,154 | huangguanru | 默认值 |
| 8 | OAG_CR-运力监控平台 | 56 | 589 | huangguanru | OAG |
| 9 | ZY经营数据分析-同比 | 51 | 298 | huangguanru | 致远数据 |
| 10 | 澳洲市场分析-DDS | 48 | 44 | huangguanru | Personal Space |

---

## 1.4 数据源详情 (Top 15)

| 数据源 | 字段数 | 工作簿数 | 类型 | 认证 |
|-------|-------|---------|-----|------|
| 中转航段数据补充票价数据-去重 | 278 | 0 | 实时 | ❌ |
| 中转航段数据补充票价数据 | 278 | 0 | 实时 | ❌ |
| 销售航段新 | 253 | 3 | 抽取 | ❌ |
| 中转航段数据关联代理人数据 | 228 | 2 | 实时 | ❌ |
| **销售航段** | **228** | **15** | 抽取 | ❌ |
| 中转航段表 | 187 | 3 | 抽取 | ❌ |
| OAG_CR | 124 | 1 | 抽取 | ❌ |
| 航班信息表-中科 | 121 | 4 | 抽取 | ❌ |
| DDS销售监控新 | 102 | 2 | 抽取 | ❌ |
| 未来预售-中科 | 92 | 4 | 抽取 | ❌ |

> ⚠️ **"销售航段"** 是复用率最高的数据源，关联15个工作簿

---

## 1.5 字段角色分布

| 角色 | 总数 | 计算字段数 | 占比 |
|-----|------|----------|------|
| (未定义) | 3,536 | 0 | 42.5% |
| MEASURE (度量) | 3,137 | 3,137 | 37.7% |
| DIMENSION (维度) | 1,641 | 1,641 | 19.7% |

---

## 1.6 数据类型分布

| 数据类型 | 总数 | 度量 | 维度 |
|---------|------|------|------|
| (未知) | 3,536 | 0 | 0 |
| REAL | 1,698 | 1,687 | 11 |
| INTEGER | 1,420 | 1,270 | 150 |
| STRING | 1,316 | 62 | 1,254 |
| BOOLEAN | 161 | 20 | 141 |
| SPATIAL | 96 | 96 | 0 |
| DATE | 64 | 0 | 64 |
| DATETIME | 23 | 2 | 21 |

---

# 二、血缘分析详细数据

## 2.1 血缘关系规模

| 关系类型 | 数量 | 说明 |
|---------|------|------|
| 表→数据源 | 81 | table_to_datasource |
| 数据源→工作簿 | 59 | datasource_to_workbook |
| **字段→视图** | **185,082** | field_to_view |
| 字段依赖 | 9,432 | field_dependencies |

---

## 2.2 端到端血缘链 (Top 5 核心表)

### 🔥 tbl_tic_trace_ticket

```
数据库: data_sandbox
    └── 表: tbl_tic_trace_ticket
         └── 数据源: 销售航段
              └── 工作簿: 15个
                   └── 视图: 493个
```

### 🔥 机场三字代码表

```
数据库: -
    └── 表: 机场三字代码表
         └── 数据源: 销售航段
              └── 工作簿: 15个
                   └── 视图: 493个
```

### 🔥 tbl_transfer_passenger

```
数据库: data_sandbox
    └── 表: tbl_transfer_passenger
         └── 数据源: 销售票面
              └── 工作簿: 4个
                   └── 视图: 281个
```

---

## 2.3 数据源血缘详情

| 数据源 | 上游表 | 下游工作簿 | 字段数 |
|-------|-------|----------|-------|
| 销售航段 | 4 | **15** | 228 |
| 航班信息表-中科 | 6 | 4 | 121 |
| 销售票面 | 2 | 4 | 81 |
| 未来预售-中科 | 5 | 4 | 92 |
| 销售航段新 | 3 | 3 | 253 |
| 中转航段表 | 1 | 3 | 187 |

---

## 2.4 字段被视图引用次数 Top 20

| 字段名 | 引用次数 | 角色 |
|-------|---------|------|
| ARRIVAL_TIME_LAG | 439 | - |
| POO-机场代码 | 439 | - |
| POO-Latitude | 439 | - |
| EXCHANGED_TICKETNUMBER | 439 | - |
| 航班号 | 439 | - |
| AGENT_NAME | 439 | - |
| CLAZZ | 439 | - |
| UPDATE_TIME | 439 | - |
| 进港-机场代码 | 439 | - |
| GDSRECORDLOCATOR | 439 | - |

> 📌 这些字段是核心业务字段，变更需进行完整的影响分析

---

## 2.5 计算字段依赖 (依赖最多的指标)

| 指标名 | 依赖字段数 | 公式片段 |
|-------|----------|---------|
| Period Flag | 10 | `IF [航班日期] >= [当期_航班开始]...` |
| 中转分类 | 9 | `IF ISNULL([Gateway 1]) then "[直达]"...` |
| 产品-剔除团队 | 8 | `IF(FIND("DCHD",[FAREBASICODE])...` |
| 分析-OD区域 | 8 | `IF [出港-Continent]="欧洲"...` |

---

## 2.6 孤立资产统计

| 资产类型 | 孤立数 | 总数 | 占比 |
|---------|-------|------|------|
| 🔴 孤立表 | 388 | 450 | **86.2%** |
| 🔴 孤立字段 | 6,341 | 8,314 | **76.3%** |
| 🟠 孤立数据源 | 27 | 53 | 50.9% |

### 孤立表示例 (部分)

- 20251020_dih.csv
- 机场三字代码表
- Orders_Central.csv
- Extract
- DIM_ZY_FlightManagement

---

# 三、使用分析详细数据

## 3.1 视图访问量 Top 30

| 排名 | 视图名 | 访问量 | 类型 | 工作簿 |
|-----|-------|-------|------|-------|
| 1 | 融合表看板 | 1,265 | dashboard | 收辅_HO融合表_星期对应 |
| 2 | 趋势看板 | 1,248 | dashboard | HSD-趋势对比 |
| 3 | 销售还原仪表盘 | 662 | dashboard | 销售数据分析-国际平台 |
| 4 | 月度航班总收益分析 | 643 | dashboard | 销售数据分析-国际平台 |
| 5 | 销售数据监控平台 | 574 | dashboard | 销售数据分析平台 |
| 6 | 航线类型 | 522 | dashboard | 销售数据分析-国际平台 |
| 7 | 日常查询 | 515 | dashboard | 销售数据分析-国际平台 |
| 8 | 看板汇总 | 505 | dashboard | 致远-预算分解 |
| 9 | 整体航线看板 | 438 | sheet | 收辅_HO收益结果_星期对应 |
| 10 | 中转销售明细表 | 424 | dashboard | 销售数据分析-国际平台 |
| 11 | 出票趋势 | 419 | dashboard | HSD-趋势对比 |
| 12 | 运力监控平台 | 399 | dashboard | OAG_CR-运力监控平台 |
| 13 | B-G舱销售情况 | 387 | dashboard | 销售数据分析-国际平台 |
| 14 | 成品 | 331 | dashboard | 收辅_HO融合表_公历对应 |
| 15 | 中小线看板 | 322 | sheet | 收辅_HO收益结果_星期对应 |

---

## 3.2 视图访问热度分布

| 级别 | 数量 | 占比 |
|-----|------|------|
| 🔴 零访问 | 1,077 | **68.9%** |
| ⚠️ 低访问(<10) | 226 | 14.4% |
| ✅ 中访问(10-100) | 209 | 13.4% |
| 🔥 高访问(>100) | 52 | 3.3% |

---

## 3.3 工作簿总访问量排名

| 工作簿 | 总访问量 | 视图数 | 平均访问 |
|-------|---------|-------|---------|
| 销售数据分析-国际平台 | 3,607 | 76 | 47.5 |
| 中科-行业收益数据 | 2,137 | 34 | 62.9 |
| HSD-趋势对比 | 1,920 | 30 | 64.0 |
| 销售数据分析平台 | 1,693 | 117 | 14.5 |
| 收辅_HO融合表_星期对应 | 1,362 | 29 | 47.0 |

---

## 3.4 数据源复用统计

| 使用情况 | 数量 | 占比 |
|---------|------|------|
| 🔴 未使用 | 27 | 50.9% |
| ⚠️ 单一使用 | 14 | 26.4% |
| ✅ 多次复用 | 12 | 22.6% |

---

## 3.5 零访问视图示例

| 视图名 | 工作簿 |
|-------|-------|
| HO国庆航班 | OAG_南京国庆 |
| 座公里排名 | ZY经营数据分析-同比 |
| 客座率分布 | ZY经营数据分析-同比 |
| 结构分析 | ZY经营数据分析-同比 |
| 指标卡1 | ZY经营数据分析-同比 |

---

# 四、时间趋势分析

## 4.1 数据源创建趋势

```
2024-08 ██ 2
2024-11 ███ 3
2024-12 █ 1
2025-03 ██ 2
2025-04 ██████████ 10  ← 峰值
2025-05 ██████ 6
2025-07 ██ 2
2025-08 ████████ 8
2025-09 ███████ 7
2025-10 ████████ 8
2025-11 ████ 4
```

## 4.2 工作簿创建趋势

```
2024-08 ███ 3
2024-09 █ 1
2025-01 ███ 3
2025-02 ██ 2
2025-03 ████ 4
2025-04 ██ 2
2025-05 ███ 3
2025-06 ██████████ 10
2025-07 ████████████ 12
2025-09 ███████ 7
2025-10 ████████ 8
2025-11 █████████████ 13  ← 峰值
2025-12 █████ 5
```

---

## 4.3 抽取数据源刷新状态

| 状态 | 数量 | 示例 |
|-----|------|------|
| ✅ 正常(<7天) | 27 | 特殊产品改期客票、GC-TCN_data |
| ⚠️ 较旧(7-30天) | 1 | - |
| 🔴 过期(>30天) | 3 | 需检查刷新调度 |

---

# 五、质量评估详细数据

## 5.1 五维质量评分

| 维度 | 得分 | 问题描述 |
|-----|------|---------|
| 完整性 | 2.8 | 99.96% 字段无描述 |
| 一致性 | 0.0 | 958 组重复公式 |
| 规范性 | 0.0 | 0% 资产认证率 |
| 有效性 | 18.8 | 86% 表孤立 |
| 时效性 | 90.3 | 仅 3 个抽取过期 |
| **综合** | **21.6** | 🔴 亟需改进 |

---

## 5.2 描述覆盖详情

| 资产类型 | 有描述 | 总数 | 覆盖率 |
|---------|-------|------|-------|
| 字段 | 3 | 8,314 | **0.04%** |
| 表 | 0 | 450 | 0% |
| 数据源 | 5 | 53 | 9.4% |

### 有描述的数据源

1. Tableau 示例数据源 (5个内置示例)

---

## 5.3 术语表详情

**已定义术语 39 条，示例：**

| 术语 | 定义 | 类别 |
|-----|------|------|
| Dashboard | 将多个工作表组合在一个视图中 | 视图类型 |
| Dimension | 包含定性值的字段，用于分类 | 字段角色 |
| Measure | 包含定量数值的字段，用于聚合 | 字段角色 |
| LOD Expression | 详细级别表达式 (FIXED/INCLUDE/EXCLUDE) | 高级计算 |
| Has Extract | 标识数据源是否创建了数据提取 | 系统属性 |

---

# 六、指标治理详细数据

## 6.1 指标概览

| 指标 | 数值 |
|-----|------|
| 计算字段总数 | 4,778 |
| 唯一公式数 | 1,677 |
| 重复公式组 | **958** |
| 字段依赖关系 | 9,432 |

---

## 6.2 重复公式详情 (出现>10次)

| 公式 | 出现次数 | 涉及指标 |
|-----|---------|---------|
| `INDEX()` | **44** | 排名、序号、始发国家排名... |
| `COUNTD([TICKETNUMBER])` | 25 | 销售票面张数 (重复命名) |
| `SUM([分摊票价])/[销售航段张数]` | 24 | 平均票价-航段不含油 |
| `IF [出港-区域]="国内" AND...` | 19 | 国内/国际航线判断 |
| `WINDOW_MEDIAN([平均票价-航段含油])` | 16 | 平均票价-中位数 |
| `IF [出港-区域] = "国际" or...` | 16 | 是否国际线 |
| `[航班日期]-[出票日期]` | 14 | 提前购票天数 |
| `ZN(SUM([分摊含油收入]))/ZN([销售航段张数])` | 14 | 平均票价-航段含油 |
| `WINDOW_MEDIAN([销售航段张数])` | 14 | 销量-中位数 |
| `RUNNING_SUM([销售航段张数])/TOTAL(...)` | 14 | 帕累托占比 |

---

## 6.3 公式长度分布

| 长度 | 数量 | 占比 |
|-----|------|------|
| 短公式(<50字符) | 2,540 | 53.2% |
| 中等公式(50-200) | 1,691 | 35.4% |
| 长公式(200-500) | 233 | 4.9% |
| 超长公式(>500) | 314 | 6.6% |

---

## 6.4 公式函数使用统计

| 函数 | 使用次数 | 说明 |
|-----|---------|------|
| **IF** | **2,527** | 条件判断最常用 |
| SUM | 1,339 | 求和 |
| COUNT/COUNTD | 485/361 | 计数 |
| ZN | 220 | 空值处理 |
| ISNULL | 168 | 空值检测 |
| LOOKUP | 123 | 查找 |
| WINDOW | 57 | 窗口函数 |
| AVG | 22 | 平均值 |
| CASE | 19 | 条件分支 |
| RUNNING | 17 | 累计计算 |

---

# 七、治理问题汇总与行动计划

## 7.1 问题优先级矩阵

| 优先级 | 问题 | 数量 | 比例 | 影响 |
|-------|-----|------|------|------|
| **P0** | 字段无描述 | 8,311 | 100% | 数据理解困难 |
| **P0** | 孤立表 | 388 | 86% | 血缘断裂 |
| **P1** | 未认证数据源 | 53 | 100% | 信任问题 |
| **P1** | 孤立字段 | 6,341 | 76% | 资源浪费 |
| **P1** | 孤立数据源 | 27 | 51% | 无人使用 |
| P2 | 零访问视图 | 1,077 | 69% | 僵尸资产 |
| P2 | 重复公式 | 958组 | - | 一致性问题 |

---

## 7.2 治理KPI目标

| 指标 | 当前 | Phase1 | Phase2 | 最终 |
|-----|------|--------|--------|------|
| 字段描述覆盖率 | 0.04% | 10% | 40% | 80% |
| 数据源认证率 | 0% | 20% | 50% | 80% |
| 表孤立率 | 86% | 50% | 30% | 10% |
| 字段孤立率 | 76% | 60% | 40% | 20% |
| 健康度得分 | 22 | 40 | 60 | **80** |

---

## 7.3 优先行动计划

### Phase 1 (1-2周) - 核心修复

| 序号 | 行动项 | 预期成果 |
|-----|-------|---------|
| 1 | 为 Top 100 高频字段补充描述 | 核心字段覆盖率 >80% |
| 2 | 评估 388 个孤立表 | 孤立率降至 50% |
| 3 | 认证 Top 10 核心数据源 | 认证率达 20% |

### Phase 2 (3-4周) - 质量提升

| 序号 | 行动项 | 预期成果 |
|-----|-------|---------|
| 4 | 统一 958 组重复公式 | 重复率降至 5% |
| 5 | 清理 6,341 个孤立字段 | 孤立率降至 40% |
| 6 | 扩展术语表至 100+ 条目 | 业务理解提升 |

### Phase 3 (持续) - 常态化治理

| 序号 | 行动项 | 预期成果 |
|-----|-------|---------|
| 7 | 建立健康度监控机制 | 定期治理报告 |
| 8 | 实施生命周期管理 | 僵尸资产 <10% |
| 9 | 保持元数据同步 | 同步成功率 >99% |

---

## 附录：核心资产清单

### A. 核心数据源 (Top 5)

1. **销售航段** - 关联15个工作簿，228字段
2. 航班信息表-中科 - 关联4个工作簿
3. 销售票面 - 关联4个工作簿
4. 未来预售-中科 - 关联4个工作簿
5. 销售航段新 - 253字段

### B. 核心表 (影响最大)

1. tbl_tic_trace_ticket - 影响493视图
2. 机场三字代码表 - 影响493视图
3. tbl_transfer_passenger - 影响281视图
4. dim_loc_agent_info - 影响202视图

### C. 热门视图 (Top 5)

1. 融合表看板 - 1,265次访问
2. 趋势看板 - 1,248次访问
3. 销售还原仪表盘 - 662次访问
4. 月度航班总收益分析 - 643次访问
5. 销售数据监控平台 - 574次访问

---

*报告生成时间: 2025-12-19 15:48*
