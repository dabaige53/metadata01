# 快速启动指南

## 🚀 启动步骤

### 1. 启动后端服务 (Flask - 8101端口)

```bash
cd /Users/w/Desktop/吉祥/Team/代码管理/metadata分析
python run.py
```

**预期输出**:
```
============================================================
  Tableau 元数据监控系统
============================================================

🌐 服务器启动中...
   地址: http://localhost:8101
   数据库: metadata.db

 * Running on http://127.0.0.1:8101
```

**验证后端**:
```bash
curl http://localhost:8101/api/stats
```

---

### 2. 启动前端服务 (Next.js - 3100端口)

**新开一个终端窗口**:

```bash
cd /Users/w/Desktop/吉祥/Team/代码管理/metadata分析/frontend
npm run dev
```

**预期输出**:
```
▲ Next.js 16.0.10
- Local:        http://localhost:3100
- Ready in 2.5s
```

**验证前端**:
```bash
curl http://localhost:3100
```

---

## ✅ 运行测试

### 基础测试

```bash
cd /Users/w/Desktop/吉祥/Team/代码管理/metadata分析
node test-e2e.js
```

**预期结果**:
```
✓ 所有测试通过！
总测试数: 12
成功率: 100.00%
```

### 功能测试

```bash
node test-features.js
```

**预期结果**:
```
✓ 所有功能测试通过！
总测试数: 27
成功率: 100.00%
```

---

## 🌐 访问地址

| 服务 | 地址 | 说明 |
|------|------|------|
| **Next.js 前端** | http://localhost:3100 | 主要使用这个 ⭐ |
| Flask 后端 | http://localhost:8101 | API 服务 |
| Flask 前端 | http://localhost:8101/ | 旧版 (对比用) |

---

## 📱 核心页面

### 新增功能页面 (Next.js - localhost:3100)

| 页面 | URL | 新功能 |
|------|-----|--------|
| **字段字典** | http://localhost:3100/fields | ✅ 筛选/排序/分页/指标依赖/视图引用 |
| **数据表** | http://localhost:3100/tables | ✅ 筛选/排序/分页/原始列/预览字段 |
| **指标库** | http://localhost:3100/metrics | ✅ 筛选/排序/分页/依赖字段可视化 |
| **工作簿** | http://localhost:3100/workbooks | ✅ 排序/分页/上游数据源 |
| 首页 | http://localhost:3100/ | 治理健康分析 |
| 数据源 | http://localhost:3100/datasources | 数据源列表 |
| 数据库 | http://localhost:3100/databases | 数据库列表 |

---

## 🧪 功能测试指南

### 测试字段字典页面

1. **访问**: http://localhost:3100/fields

2. **测试筛选**:
   - 点击 "度量" 标签 → 看到只显示度量字段
   - 点击 "string" 标签 → 看到只显示字符串类型
   - 同时选择多个 → 看到筛选结果

3. **测试排序**:
   - 点击 "热度↓" 按钮 → 按使用次数降序
   - 再次点击 → 变成 "热度↑" 升序
   - 点击 "名称" → 按名称排序

4. **测试分页**:
   - 查看底部分页控件
   - 点击 "下一页" → 跳转到第2页
   - URL 变为 `/fields?page=2`

5. **测试新增列**:
   - 查看 "指标依赖" 列 → 显示依赖的指标标签
   - 点击指标标签 → 打开指标详情抽屉
   - 查看 "视图引用" 列 → 显示引用数量

### 测试数据表页面

1. **访问**: http://localhost:3100/tables

2. **测试筛选**:
   - 点击 Schema 标签 (如 "public") → 筛选结果

3. **测试排序**:
   - 点击 "字段数↓" → 按字段数量排序

4. **测试新增列**:
   - 查看 "原始列" 列 → 显示数据库原始列数
   - 查看 "预览字段" 列 → 显示度量/维度标签
   - 度量标签为绿色，维度标签为蓝色

### 测试指标库页面

1. **访问**: http://localhost:3100/metrics

2. **测试筛选**:
   - 点击 "业务指标" → 筛选业务类型
   - 点击 "是" (有重复) → 显示重复指标

3. **测试排序**:
   - 点击 "复杂度↓" → 按复杂度排序

4. **测试可视化**:
   - 查看 "依赖字段" 列
   - 看到圆形头像叠加显示
   - 绿色 = 度量，蓝色 = 维度
   - 鼠标悬停显示完整字段名

### 测试工作簿页面

1. **访问**: http://localhost:3100/workbooks

2. **测试排序**:
   - 点击 "视图数↓" → 按视图数量排序

3. **测试上游数据源**:
   - 查看 "上游数据源" 列
   - 看到蓝紫色标签显示数据源名称
   - 超过3个显示 "+N"

---

## 🎨 视觉验证

### 筛选器样式
- ✓ Chip 样式标签
- ✓ 圆角边框
- ✓ 激活状态为蓝紫色
- ✓ 数字计数显示

### 排序按钮样式
- ✓ 激活状态高亮
- ✓ 箭头指示方向 (↓/↑)
- ✓ 圆角按钮

### 分页控件样式
- ✓ 当前页高亮 (蓝紫色)
- ✓ 禁用按钮灰色
- ✓ 总数显示清晰

### 表格样式
- ✓ 交替行背景
- ✓ 悬停效果 (灰色背景)
- ✓ 图标对齐
- ✓ 标签颜色区分

---

## 🔍 对比测试

### 与 Flask 8101 版本对比

1. **打开两个浏览器窗口**:
   - 左侧: http://localhost:8101/ (Flask 旧版)
   - 右侧: http://localhost:3100/ (Next.js 新版)

2. **对比功能**:
   - ✓ 筛选功能完全一致
   - ✓ 排序功能完全一致
   - ✓ 分页功能完全一致
   - ✓ 数据列完全一致

3. **新版优势**:
   - ✓ TypeScript 类型安全
   - ✓ 组件化架构更清晰
   - ✓ URL 状态同步更好
   - ✓ 性能更优 (客户端筛选)

---

## ⚠️ 常见问题

### Q1: 前端无法访问

**检查端口**:
```bash
lsof -i :3100
```

如果没有输出，说明前端未启动:
```bash
cd frontend
npm run dev
```

### Q2: 后端 API 错误

**检查后端**:
```bash
curl http://localhost:8101/api/stats
```

如果无响应:
```bash
python run.py
```

### Q3: 数据不显示

**检查浏览器控制台**:
- 按 F12 打开开发者工具
- 查看 Console 标签页
- 查看 Network 标签页

### Q4: 测试失败

**确保服务都已启动**:
```bash
# 检查后端
curl http://localhost:8101/api/stats

# 检查前端
curl http://localhost:3100

# 然后运行测试
node test-e2e.js
```

---

## 📊 验收标准

### 必须通过

- [x] ✅ 编译成功
- [x] ✅ 所有页面能打开
- [x] ✅ 筛选功能正常
- [x] ✅ 排序功能正常
- [x] ✅ 分页功能正常
- [x] ✅ 新增列显示正常
- [x] ✅ 可视化效果正常

### 推荐测试

- [ ] 浏览器兼容性 (Chrome/Firefox/Safari)
- [ ] 响应式布局 (手机/平板)
- [ ] 性能测试 (大量数据)

---

## 🎉 成功标志

当你看到以下情况，说明系统运行正常：

1. ✅ 两个终端窗口都显示服务运行中
2. ✅ 访问 http://localhost:3100 能看到页面
3. ✅ 字段字典页面有筛选器
4. ✅ 点击筛选标签能看到结果变化
5. ✅ 点击排序按钮能看到顺序变化
6. ✅ 点击分页能看到页码变化
7. ✅ URL 会随着操作更新
8. ✅ 运行测试显示 "100% 通过"

---

## 📞 下一步

系统已经可以正常使用！

**如需进一步优化**:
- 查看 `差异分析和修复方案.md` (详细规划)
- 查看 `升级完成报告.md` (技术细节)
- 查看 `E2E测试报告.md` (测试详情)

**如有问题**:
- 检查控制台错误信息
- 运行测试脚本定位问题
- 查看浏览器开发者工具

---

**文档更新时间**: 2025-12-18
**系统状态**: ✅ 已就绪，可投入使用
